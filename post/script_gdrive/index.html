<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Membaca Folder Google Drive Otomatis | arifsatuan</title><meta name=keywords content="notes,googlescript"><meta name=description content="Catatan kali ini diinspirasi dari &ldquo;kemalasan&rdquo; untuk tiap folder di google drive. Ceritanya sedang membuat folder yang diisi bersama, namun perlu dikonfirmasi siapa saja yang sudah dan siapa saja yang belum. Jika hanya kurang dari 10 tentu tidak masalah, lain halnya jika banyak folder yang harus dicek.
Membuat Folder Gdrive Langkah pertama tentu saja membuat folder utama gdrive dan catat ID folder. Misal kita buat folder dengan nama MainFolder dan berisi subfolder seperti berikut Dimana nanti akhirnya kita ingin setiap subfolder diisi/diupload penanggungjawabnya seperti subfolder3 dan subfolder4"><meta name=author content="arf"><link rel=canonical href=https://arifsatuan.github.io/post/script_gdrive/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://arifsatuan.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://arifsatuan.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://arifsatuan.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://arifsatuan.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://arifsatuan.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Membaca Folder Google Drive Otomatis"><meta property="og:description" content="Catatan kali ini diinspirasi dari &ldquo;kemalasan&rdquo; untuk tiap folder di google drive. Ceritanya sedang membuat folder yang diisi bersama, namun perlu dikonfirmasi siapa saja yang sudah dan siapa saja yang belum. Jika hanya kurang dari 10 tentu tidak masalah, lain halnya jika banyak folder yang harus dicek.
Membuat Folder Gdrive Langkah pertama tentu saja membuat folder utama gdrive dan catat ID folder. Misal kita buat folder dengan nama MainFolder dan berisi subfolder seperti berikut Dimana nanti akhirnya kita ingin setiap subfolder diisi/diupload penanggungjawabnya seperti subfolder3 dan subfolder4"><meta property="og:type" content="article"><meta property="og:url" content="https://arifsatuan.github.io/post/script_gdrive/"><meta property="og:image" content="https://arifsatuan.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-10-02T15:18:27+07:00"><meta property="article:modified_time" content="2022-10-02T15:18:27+07:00"><meta property="og:site_name" content="Arif Satuan"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://arifsatuan.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Membaca Folder Google Drive Otomatis"><meta name=twitter:description content="Catatan kali ini diinspirasi dari &ldquo;kemalasan&rdquo; untuk tiap folder di google drive. Ceritanya sedang membuat folder yang diisi bersama, namun perlu dikonfirmasi siapa saja yang sudah dan siapa saja yang belum. Jika hanya kurang dari 10 tentu tidak masalah, lain halnya jika banyak folder yang harus dicek.
Membuat Folder Gdrive Langkah pertama tentu saja membuat folder utama gdrive dan catat ID folder. Misal kita buat folder dengan nama MainFolder dan berisi subfolder seperti berikut Dimana nanti akhirnya kita ingin setiap subfolder diisi/diupload penanggungjawabnya seperti subfolder3 dan subfolder4"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://arifsatuan.github.io/post/"},{"@type":"ListItem","position":2,"name":"Membaca Folder Google Drive Otomatis","item":"https://arifsatuan.github.io/post/script_gdrive/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Membaca Folder Google Drive Otomatis","name":"Membaca Folder Google Drive Otomatis","description":"Catatan kali ini diinspirasi dari \u0026ldquo;kemalasan\u0026rdquo; untuk tiap folder di google drive. Ceritanya sedang membuat folder yang diisi bersama, namun perlu dikonfirmasi siapa saja yang sudah dan siapa saja yang belum. Jika hanya kurang dari 10 tentu tidak masalah, lain halnya jika banyak folder yang harus dicek.\nMembuat Folder Gdrive Langkah pertama tentu saja membuat folder utama gdrive dan catat ID folder. Misal kita buat folder dengan nama MainFolder dan berisi subfolder seperti berikut Dimana nanti akhirnya kita ingin setiap subfolder diisi/diupload penanggungjawabnya seperti subfolder3 dan subfolder4","keywords":["notes","googlescript"],"articleBody":"Catatan kali ini diinspirasi dari “kemalasan” untuk tiap folder di google drive. Ceritanya sedang membuat folder yang diisi bersama, namun perlu dikonfirmasi siapa saja yang sudah dan siapa saja yang belum. Jika hanya kurang dari 10 tentu tidak masalah, lain halnya jika banyak folder yang harus dicek.\nMembuat Folder Gdrive Langkah pertama tentu saja membuat folder utama gdrive dan catat ID folder. Misal kita buat folder dengan nama MainFolder dan berisi subfolder seperti berikut Dimana nanti akhirnya kita ingin setiap subfolder diisi/diupload penanggungjawabnya seperti subfolder3 dan subfolder4\n├── MainFolder │ ├── subfolder1 │ ├── subfolder2 │ ├── subfolder3 │ │ ├──file.pdf │ ├── subfolder4 │ │ ├──file.pdf │ ├── dst . . . File tidak harus .pdf bisa berupa file apa saja.\nPada alamat google drive, ada bagian yang menunjukkan Folder Id\nhttps://drive.google.com/drive/folders/1NLGj1fbN7Gl2Fp1qVqxoC8OnURxlFl1l Perhatikan 1NLGj1fbN7Gl2Fp1qVqxoC8OnURxlFl1l adalah folder Id.\nMembuat Spreadsheet dan Macro Langkah selanjutnya adalah membuat file spreadsheet dengan perintah sheet.new di address bar browser kesayangan.\nBuat script dengan klik menu extensions-\u003e AppScript Lalu Paste code berikut.\nfunction onOpen() { var SS = SpreadsheetApp.getActiveSpreadsheet(); var ui = SpreadsheetApp.getUi(); ui.createMenu(\"List Files/Folders\") .addItem(\"List All Files and Folders\", \"listFilesAndFolders\") .addToUi(); }; function listFilesAndFolders(){ //masukkan Folder Id si ini var folderId=\"1NLGj1fbN7Gl2Fp1qVqxoC8OnURxlFl1l\"; getFolderTree(folderId, true); }; function getFolderTree(folderId, listAll) { try { var parentFolder = DriveApp.getFolderById(folderId); var file, data, sheet = SpreadsheetApp.getActiveSpreadsheet(). getSheetByName(\"listing\"); // \"listing\" adalah nama sheet yang akan menyimpan sheet.clear(); sheet.appendRow([\"Full Path\", \"Name\",\"Type\" ,\"Size\"]); getChildFolders(parentFolder.getName(), parentFolder, data, sheet, listAll); } catch (e) { Logger.log(e.toString()); } }; function getChildFolders(parentName, parent, data, sheet, listAll) { var childFolders = parent.getFolders(); while (childFolders.hasNext()) { var childFolder = childFolders.next(); // List files inside the folder var files = childFolder.getFiles(); while (listAll \u0026 files.hasNext()) { var childFile = files.next(); data = [ parentName + \"/\" + childFolder.getName() , childFile.getName(), \"Files\", childFile.getSize()/1024, ]; sheet.appendRow(data); } getChildFolders(parentName + \"/\" + childFolder.getName(), childFolder, data, sheet, listAll); } }; Simpan dan klik run , kemudian jika ada pop up pilih review dan allow Kembali ke google spreadsheet, dengan sheet yang diberi nama listing dan run menu baru di atas\nMaka akan muncul nama file yang sudah dimasukkan ke subfolder 1,2,3 (sebagai contoh), sedangkan subfolder4 dan subfolder5 belum diisi.\nGunakan Vlookup Bagian selanjutnya adalah memanfaatkan vlookup, concatenate dengan variabel size. Jika size lebih dari 0 maka dianggap sudah terupload filenya.\n=if(value(iferror(vlookup(\"MainFolder/\"\u0026B2,listing!$A$2:$D,4,false),\"\"))\u003e=1,\"☑\",\"☐\") Tips! Jika ingin membuat folder untuk satu kantor, sekolah, gunakan nama yang bagus seperti NIS, Nomor Karyawan, dsb.\nJika berminat untuk copy file spreadsheet bisa buka link berikut\n","wordCount":"404","inLanguage":"en","datePublished":"2022-10-02T15:18:27+07:00","dateModified":"2022-10-02T15:18:27+07:00","author":{"@type":"Person","name":"arf"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://arifsatuan.github.io/post/script_gdrive/"},"publisher":{"@type":"Organization","name":"arifsatuan","logo":{"@type":"ImageObject","url":"https://arifsatuan.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://arifsatuan.github.io/ accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://arifsatuan.github.io/archives/ title=archives><span>archives</span></a></li><li><a href=https://arifsatuan.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=http://diguru.info title=diguru.info><span>diguru.info</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://arifsatuan.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://arifsatuan.github.io/post/>Posts</a></div><h1 class=post-title>Membaca Folder Google Drive Otomatis</h1><div class=post-meta><span title='2022-10-02 15:18:27 +0700 WIB'>October 2, 2022</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;404 words&nbsp;·&nbsp;arf</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#membuat-folder-gdrive>Membuat Folder Gdrive</a></li><li><a href=#membuat-spreadsheet-dan-macro>Membuat Spreadsheet dan Macro</a></li><li><a href=#gunakan-vlookup>Gunakan Vlookup</a></li></ul></nav></div></details></div><div class=post-content><p>Catatan kali ini diinspirasi dari &ldquo;kemalasan&rdquo; untuk tiap folder di google drive. Ceritanya sedang membuat folder yang diisi bersama, namun perlu dikonfirmasi siapa saja yang sudah dan siapa saja yang belum. Jika hanya kurang dari 10 tentu tidak masalah, lain halnya jika banyak folder yang harus dicek.</p><h2 id=membuat-folder-gdrive>Membuat Folder Gdrive<a hidden class=anchor aria-hidden=true href=#membuat-folder-gdrive>#</a></h2><p>Langkah pertama tentu saja membuat folder utama gdrive dan catat ID folder. Misal kita buat folder dengan nama <code>MainFolder</code> dan berisi subfolder seperti berikut
<img loading=lazy src=gdrive1.png alt="Folder Google Drive">
Dimana nanti akhirnya kita ingin setiap subfolder diisi/diupload penanggungjawabnya seperti <code>subfolder3</code> dan <code>subfolder4</code></p><pre tabindex=0><code>├── MainFolder
│   ├── subfolder1
│   ├── subfolder2
│   ├── subfolder3
│   │   ├──file.pdf
│   ├── subfolder4
│   │   ├──file.pdf
│   ├── dst . . .
</code></pre><p>File tidak harus <strong>.pdf</strong> bisa berupa file apa saja.</p><p>Pada alamat google drive, ada bagian yang menunjukkan <strong>Folder Id</strong></p><pre tabindex=0><code>https://drive.google.com/drive/folders/1NLGj1fbN7Gl2Fp1qVqxoC8OnURxlFl1l
</code></pre><p>Perhatikan <code>1NLGj1fbN7Gl2Fp1qVqxoC8OnURxlFl1l</code> adalah folder Id.</p><h2 id=membuat-spreadsheet-dan-macro>Membuat Spreadsheet dan Macro<a hidden class=anchor aria-hidden=true href=#membuat-spreadsheet-dan-macro>#</a></h2><p>Langkah selanjutnya adalah membuat file spreadsheet dengan perintah <code>sheet.new</code> di address bar browser kesayangan.</p><p><img loading=lazy src=sheet1.png alt="Apps Script pada Spreadsheet">
Buat script dengan klik menu <code>extensions-> AppScript</code> Lalu Paste
code berikut.</p><pre tabindex=0><code>function onOpen() {
  var SS = SpreadsheetApp.getActiveSpreadsheet();
  var ui = SpreadsheetApp.getUi();
  ui.createMenu(&#34;List Files/Folders&#34;)
    .addItem(&#34;List All Files and Folders&#34;, &#34;listFilesAndFolders&#34;)
    .addToUi();
};

function listFilesAndFolders(){
//masukkan Folder Id si ini
  var folderId=&#34;1NLGj1fbN7Gl2Fp1qVqxoC8OnURxlFl1l&#34;;
  getFolderTree(folderId, true); 
};


function getFolderTree(folderId, listAll) {
  try {
   var parentFolder = DriveApp.getFolderById(folderId);
   var file, data, sheet = SpreadsheetApp.getActiveSpreadsheet().  getSheetByName(&#34;listing&#34;);
// &#34;listing&#34; adalah nama sheet yang akan menyimpan
    sheet.clear();
    sheet.appendRow([&#34;Full Path&#34;, &#34;Name&#34;,&#34;Type&#34; ,&#34;Size&#34;]);
   getChildFolders(parentFolder.getName(), parentFolder, data, sheet, listAll);
  } catch (e) {
    Logger.log(e.toString());
  }
};

function getChildFolders(parentName, parent, data, sheet, listAll) {
  var childFolders = parent.getFolders();
 
  while (childFolders.hasNext()) {
    var childFolder = childFolders.next();
    
    // List files inside the folder
    var files = childFolder.getFiles();
   while (listAll &amp; files.hasNext()) {
      var childFile = files.next();
      data = [ 
        parentName + &#34;/&#34; + childFolder.getName() ,
        childFile.getName(),
        &#34;Files&#34;,
        childFile.getSize()/1024,
       ];
     
      sheet.appendRow(data);
    } 
        getChildFolders(parentName + &#34;/&#34; + childFolder.getName(), childFolder, data, sheet, listAll);  
  }
};
</code></pre><p>Simpan dan klik run , kemudian jika ada pop up pilih <code>review</code> dan <code>allow</code>
<img loading=lazy src=script1.png alt="google script"></p><p>Kembali ke google spreadsheet, dengan sheet yang diberi nama <code>listing</code> dan run menu baru di atas</p><p><img loading=lazy src=sheet2.png alt="menjalankan menu custom"></p><p>Maka akan muncul nama file yang sudah dimasukkan ke subfolder 1,2,3 (sebagai contoh), sedangkan subfolder4 dan subfolder5 belum diisi.</p><h2 id=gunakan-vlookup>Gunakan Vlookup<a hidden class=anchor aria-hidden=true href=#gunakan-vlookup>#</a></h2><p>Bagian selanjutnya adalah memanfaatkan <code>vlookup</code>, <code>concatenate</code> dengan variabel size. Jika size lebih dari 0 maka dianggap sudah terupload filenya.</p><pre tabindex=0><code>=if(value(iferror(vlookup(&#34;MainFolder/&#34;&amp;B2,listing!$A$2:$D,4,false),&#34;&#34;))&gt;=1,&#34;☑&#34;,&#34;☐&#34;)
</code></pre><p><img loading=lazy src=sheet3.png alt=vlookup></p><blockquote><p>Tips! Jika ingin membuat folder untuk satu kantor, sekolah, gunakan nama yang bagus seperti NIS, Nomor Karyawan, dsb.</p></blockquote><p>Jika berminat untuk <em>copy</em> file spreadsheet bisa buka <a href=https://docs.google.com/spreadsheets/d/1VlWEyLayLjpwTselyJLoytKSI9P0SCwHoYGCLHmR1Wk/copy>link berikut</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://arifsatuan.github.io/tags/notes/>notes</a></li><li><a href=https://arifsatuan.github.io/tags/googlescript/>googlescript</a></li></ul><nav class=paginav><a class=prev href=https://arifsatuan.github.io/post/script_folder/><span class=title>« Prev</span><br><span>Membuat Folder Otomatis</span></a>
<a class=next href=https://arifsatuan.github.io/post/hello/><span class=title>Next »</span><br><span>Hello World</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://arifsatuan.github.io/>arifsatuan</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>